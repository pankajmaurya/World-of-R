fm <- lm(y ~ x)
summary(fm)
plot(x, y)
s <- summary(fm)
class(s)
str(s)
coef(lm)
coef(fm)
coef(s)
cm <- coef(s)
cm
print(cm)
cm["(Intercept)"]
cm["(Intercept)", "Pr(>|t|)"]
?Arithmetic
?cumsum
cumsum(1:10)
?ifelse
x <- c(10.25, 10.06, 10.0, 10.78, 10.56, 10.08, 10.72, 10.56, 10.66)
y <- c(10.93, 10.73, 10.2, 10.72, 10.68, 10.86, 10.32, 10.18, 10.77, 10.29)
m <- length(x)
n <- length(y)
xbar <- mean(x)
ybar <- mean(y)
Sp2 <- (sum((x - xbar)^2) + sum((y - ybar)^2)) / (m + n - 2)
T  <- (xbar - ybar) / sqrt(Sp2 * (1/m + 1/n))
degFreedom <- m + n - 2
pval <- 2 * pt(abs(T), df = degFreedom, lower.tail = FALSE)
result <- list(means = c(xbar, ybar),
sizes = c(m, n),
statistic = T,
pooled.variance = Sp2,
p.value = pval,
alternative = "both-sided")
?pt
two_sample_ttest <- function(x, y) {
m <- length(x)
n <- length(y)
xbar <- mean(x)
ybar <- mean(y)
Sp2 <- (sum((x - xbar)^2) + sum((y - ybar)^2)) / (m + n - 2)
T  <- (xbar - ybar) / sqrt(Sp2 * (1/m + 1/n))
degFreedom <- m + n - 2
pval <- 2 * pt(abs(T), df = degFreedom, lower.tail = FALSE)
result <- list(means = c(xbar, ybar),
sizes = c(m, n),
statistic = T,
pooled.variance = Sp2,
p.value = pval,
alternative = "both-sided")
class(result) <- "ttest2"
result
}
two_sample_ttest(x, y)
print.ttest2 <- function(x, ...) {
cat("Two-sample t-test with equal variance\n")
cat("- Statistic:", x$statistic, "with", sum(x$sizes) - 2, "degrees of freedom\n")
cat("- p-value  :", x$p.value)
}
two_sample_ttest(x, y)
setwd("~/TechCareer/World-of-R")
df <- read.csv("marks-10-and-12.csv")
#df <- read.csv("yourfile.csv")   # <-- replace with your CSV filename
df$id <- 1:nrow(df)
# -----------------------------
# 2. PAIRED t-TEST
# -----------------------------
#print(t.test(df$before, df$after, paired = TRUE))
print(t.test(marks$marks10, marks$marks12, paired = TRUE))
# For reference
# -----------------------------
# 1. READ CSV
# -----------------------------
setwd("~/TechCareer/World-of-R")
df <- read.csv("marks-10-and-12.csv")
#df <- read.csv("yourfile.csv")   # <-- replace with your CSV filename
df$id <- 1:nrow(df)
# -----------------------------
# 2. PAIRED t-TEST
# -----------------------------
#print(t.test(df$before, df$after, paired = TRUE))
print(t.test(df$marks10, df$marks12, paired = TRUE))
x <- rnorm(10)
y <- rnorm(10)
w <- x - y
w
mean(w)
help(sd)
sd(w)
length(w)
1/sqrt(10) * sqrt(sum((w-mean(w))^2)) / sqrt(9)
1/sqrt(9) * sqrt(sum((w-mean(w))^2)) / sqrt(9)
sd(w)
w
csv.write(w, "/home/pankaj/w.csv")
write.csv(w, "/home/pankaj/w.csv")
write.csv(w, "/home/pankaj/w.csv")
write.csv(w, "/Users/pankaj/w.csv")
sqrt(sum((w-mean(w))^2)) / sqrt(9)
tpaired <- function(x, y) {
# the t statistic is mean(w)/sd(w) where w = x - y
w <- x - y
n <- length(x)
T <- mean(w) / (1/sqrt(n) * sqrt(sum((w-mean(w))^2)) / sqrt(n-1))
df <- n - 1
pval <- 2 * pt(abs(statistic), df = df, lower.tail = FALSE)
result <- list(statistic = T, df = df, p.value = pval, alternative = "both-sided")
class(result) <- "tpaired"
result
}
if (tpaired(rnorm(10), rnorm(10))$df != 9) cat("ERROR: wrong degrees of freedom")
tpaired <- function(x, y) {
# the t statistic is mean(w)/sd(w) where w = x - y
w <- x - y
n <- length(x)
T <- mean(w) / (1/sqrt(n) * sqrt(sum((w-mean(w))^2)) / sqrt(n-1))
df <- n - 1
pval <- 2 * pt(abs(T), df = df, lower.tail = FALSE)
result <- list(statistic = T, df = df, p.value = pval, alternative = "both-sided")
class(result) <- "tpaired"
result
}
if (tpaired(rnorm(10), rnorm(10))$df != 9) cat("ERROR: wrong degrees of freedom")
tpaired(df$marks10, df$marks12)$statitic
tpaired(df$marks10, df$marks12)$statistic
# -----------------------------
# 2. PAIRED t-TEST
# -----------------------------
#print(t.test(df$before, df$after, paired = TRUE))
print(t.test(df$marks10, df$marks12, paired = TRUE))
tpaired(df$marks10, df$marks12)$p.value
help(pt)
help(pt)
print.tpaired <- function(x, ...) {
cat("Paired t-test \n")
cat("- Statistic:", x$statistic, "with", x$df, "degrees of freedom\n")
cat("- p-value  :", x$p.value)
}
# -----------------------------
# 2. PAIRED t-TEST
# -----------------------------
#print(t.test(df$before, df$after, paired = TRUE))
print(t.test(df$marks10, df$marks12, paired = TRUE))
tpaired(df$marks10, df$marks12)
tpaired <- function(x, y) {
# the t statistic is mean(w)/sd(w) where w = x - y
w <- x - y
n <- length(x)
T <- mean(w) / (1/sqrt(n) * sqrt(sum((w-mean(w))^2)) / sqrt(n-1))
df <- n - 1
# twice of upper tailed probability gives the pvalue.
pval <- 2 * pt(abs(T), df = df, lower.tail = FALSE)
result <- list(statistic = T, df = df, p.value = pval, alternative = "two-sided")
class(result) <- "tpaired"
result
}
tpaired(df$marks10, df$marks12)
tpaired <- function(x, y) {
# the t statistic is mean(w)/sd(w) where w = x - y
w <- x - y
n <- length(x)
T <- mean(w) / (1/sqrt(n) * sqrt(sum((w-mean(w))^2)) / sqrt(n-1))
df <- n - 1
# twice of upper tailed probability gives the pvalue.
pval <- 2 * pt(abs(T), df = df, lower.tail = FALSE)
result <- list(statistic = T, df = df, p.value = pval, alternative = "two.sided")
class(result) <- "tpaired"
result
}
tpaired(df$marks10, df$marks12)
print.tpaired_with_help <- function(x, ...) {
cat("Paired t-test (production like)\n")
cat("- Statistic:", x$statistic, "with", x$df, "degrees of freedom\n")
cat("- p-value  :", x$p.value)
}
tpaired_with_help(df$marks10, df$marks12)
tpaired_with_help <- function(x, y) {
stopifnot(length(x) == length(y))
w <- x - y
n <- length(w)
if (n < 2) stop("not enough observations")
wbar <- mean(w)
sw <- sd(w)
T <- wbar / (sw / sqrt(n))
df <- n - 1
pval <- 2 * pt(abs(T), df = df, lower.tail = FALSE)
result <- list(
statistic = T,
df = df,
p.value = pval,
alternative = "two.sided",
estimate = wbar
)
class(result) <- "tpaired_with_help"
result
}
tpaired_with_help(df$marks10, df$marks12)
sReLU <- function(u) {
if (u < 0) u = 0
u
}
x <- -5
sReLU(x)
x
vReLU <- function(u) {
for (i in seq_len(length(u))) {
if (u[i] < 0) {
u[i] <- 0
}
}
return(u)
}
x <- rnorm(10)
y <- x
x
y
z <- vReLU(y)
y
x
z
# Alternative: Direct assignment
y[y < 0] <- 0
y
x
# Modifying names of a dataframe
d <- data.frame(1, rnorm(5), rexp(5))
names(d)
setNames(d, c("Constant", "Normal", "Exponential"))
d
d2 <- setNames(d, c("Constant", "Normal", "Exponential"))
d2
# Replacement function approach
names(d) <- c("Constant", "Normal", "Exponential")
d
# Other examples of replacement functions.
d$Normal[d$Normal < 0] <- 0
d
help(Devices)
image(volcano)
persp(volcano)
wireframe(volcano, shade = TRUE)
library(lattice)
wireframe(volcano, shade = TRUE)
cloud((-depth) ~ lat + long, data = quakes)
library(rgl)
methods(plot)
m <- sample(month.name, 30, replace = TRUE)
m
class(m)
plot(m)
plot(factor(m, levels = month.name), las = 2)
plot(factor(m, levels = month.name), las = 2) # las = label style
plot(factor(m, levels = month.name), las = 3) # las = label style
plot(factor(m, levels = month.name), las = 13) # las = label style
plot(factor(m, levels = month.name), las = 1) # las = label style
plot(factor(m, levels = month.name), las = 2) # las = label style
x <- c(rnorm(30, sd = 0.5), rnorm(40, mean = 3))
d <- density(x)
e <- ecdf(x)
plot(d)
x
plot(e)
# Data frames
library(package = "MASS")
plot(crabs[3:8], col = as.numeric(crabs$sp), pch = as.numeric(crabs$sex))
plot(crabs[3:8], col = as.numeric(crabs$sp), pch = as.numeric(crabs$sex))
# Regression Models
y <- rnorm(length(x), mean = 2 + 3 * x + x^2, sd = 1.5)
plot(y ~ x)
fm <- lm(y ~ x)
summary(fm)
plot(fm)
m <- sample(month.name, 100, replace = TRUE)
mt <- sort(table(m), decreasing = TRUE)
mdf <- data.frame(mt)
str(mdf)
mdf[1]
mdf[2]
mdf[2][1]
mdf[2][2]
mdf[2]
library(ggplot2)
library(lattice)
library(graphics)
options(repr.plot.width = 12, repr.plot.height = 6) # change image size in Jupyter
gp <- ggplot(mdf, aes(x = m, y = Freq)) + geom_col()
lp <- barchart(Freq ~ m, mdf, origin = 0)
tp <- barplot(Freq ~ m, mdf)
m
mt
print(gp)
print(lp)
update(lp, xlab = "month", ylab = "frequency")
gp + xlab("month") + ylab("frequency")
print(tp)
tp <- barplot(Freq ~ m, mdf)
print(tp)
?ToothGrowth
library(ggplot2)
p <- ggplot(ToothGrowth) + facet_wrap(~ supp)
p + geom_point(aes(x = dose, y = len))
fm1 <- lm(len ~ dose, data = ToothGrowth)
summary(fm1)
expand.grid(supp=c("VC", "OJ"), dose = c(0.5, 1, 2))
with(ToothGrowth, expand.grid(supp = unique(supp), dose = unique(dose)))
# leaving out the response variable.
udf <- unique(ToothGrowth[-1])
predict(fm1, udf)
udf1 <- cbind(udf, fit = predict(fm1, udf))
?cbind
p + geom_point(aes(x = dose, y = len)) + geom_line(aes(x = dose, y = fit), data = udf1)
udf1conf <- cbind(udf, predict(fm1, udf, interval = "confidence"))
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf1) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf1conf, width = 0.1, col = 2)
# Now we get the prediction intervals
udf1pred <- cbind(udf, predict(fm1, udf, interval = "prediction"))
udf1pred
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf1) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf1pred, width = 0.1, col = 2)
# Anova model session now
fm2 <- lm(len ~ factor(dose), data = ToothGrowth)
summary(fm2)
fm2 <- aov(len ~ factor(dose), data = ToothGrowth)
udf2conf <- cbind(udf, predict(fm2, udf, interval = "confidence"))
udf2conf
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf2conf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf2conf, width = 0.1, col = 2)
sum(residuals(fm1)^2)
sum(residuals(fm2)^2)
# compares the 2 models
anova(fm1, fm2)
fm3 <- lm(len ~ log(dose), data = ToothGrowth)
sum(residuals(fm3)^2)
anova(fm3, fm2)
fm4 <- aov(len ~ paste(supp, dose, sep = "_"), data = ToothGrowth)
# H0: The simpler model (log(dose)) fits as well as factor(dose)
# H1: factor(dose) provides a significantly better fit.
# p = 0.239 > 0.05 => Fail to reject null Hypotheses. Accept the null hypotheses then.
# Now the P value is no longer significant at the 5% cutoff level. However the predict method continues to work.
udf3conf <- cbind(udf, predict(fm3, udf, interval = "confidence"))
udf3conf
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf3conf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf3conf, width = 0.1, col = 2)
fm4 <- aov(len ~ paste(supp, dose, sep = "_"), data = ToothGrowth)
udf4conf <- cbind(udf, predict(fm4, udf, interval = "confidence"))
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf4conf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf4conf, width = 0.1, col = 2)
# Is this an improvement over fm2?
anova(fm2, fm4)
# Such models are known as interaction models.
# Notation for such models which are very common:
fm5 <- aov(len ~ supp * factor(dose), data = ToothGrowth)
anova(fm2, fm5)
udf5conf <- cbind(udf, predict(fm5, udf, interval = "confidence"))
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf5conf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf5conf, width = 0.1, col = 2)
# explore additive model.one way Anova models.
xtabs(~ supp + dose, ToothGrowth)
fm6 <- aov(len ~ supp + factor(dose), data = ToothGrowth)
sum(residuals(fm6)^2)
udf6conf <- cbind(udf, predict(fm6, udf, interval = "confidence"))
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf6conf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf6conf, width = 0.1, col = 2)
fm3 <- lm(len ~ log(dose), data = ToothGrowth)
udf <- unique(ToothGrowth[-1])
udf3conf <- cbind(udf, predict(fm3, udf, interval = "confidence"))
print(udf3conf)
fm7 <- aov(len ~ supp + log(dose), data = ToothGrowth)
# Lets plot.
library(ggplot2)
p <- ggplot(ToothGrowth) + facet_wrap(~ supp)
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf3conf, width = 0.1, col = 2)
fm3 <- lm(len ~ log(dose), data = ToothGrowth)
udf <- unique(ToothGrowth[-1])
udf3conf <- cbind(udf, predict(fm3, udf, interval = "confidence"))
print(udf3conf)
p <- ggplot(ToothGrowth) + facet_wrap(~ supp)
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf3conf, width = 0.1, col = 2)
library(ggplot2)
p <- ggplot(ToothGrowth) + facet_wrap(~ supp)
p + geom_point(aes(x = dose, y = len))
fm1 <- lm(len ~ dose, data = ToothGrowth)
predict(fm1, udf)
udf1 <- cbind(udf, fit = predict(fm1, udf))
p + geom_point(aes(x = dose, y = len)) + geom_line(aes(x = dose, y = fit), data = udf1)
udf1conf <- cbind(udf, predict(fm1, udf, interval = "confidence"))
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf1) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf1conf, width = 0.1, col = 2)
fm3 <- lm(len ~ log(dose), data = ToothGrowth)
udf <- unique(ToothGrowth[-1])
udf3conf <- cbind(udf, predict(fm3, udf, interval = "confidence"))
print(udf3conf)
geom_line(aes(x = dose, y = fit), data = udf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), da
fm3 <- lm(len ~ log(dose), data = ToothGrowth)
fm3 <- lm(len ~ log(dose), data = ToothGrowth)
udf <- unique(ToothGrowth[-1])
udf3conf <- cbind(udf, predict(fm3, udf, interval = "confidence"))
# Lets plot.
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf3conf, width = 0.1, col = 2)
p <- ggplot(ToothGrowth) + facet_wrap(~ supp)
p + geom_point(aes(x = dose, y = len))
# Lets plot.
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf3conf, width = 0.1, col = 2)
predict(fm3, udf)
udf3 <- cbind(udf, fit = predict(fm3, udf))
# Lets plot.
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf3) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf3conf, width = 0.1, col = 2)
fm3 <- lm(len ~ log(dose), data = ToothGrowth)
udf <- unique(ToothGrowth[-1])
predict(fm3, udf)
udf3 <- cbind(udf, fit = predict(fm3, udf))
udf3conf <- cbind(udf, predict(fm3, udf, interval = "confidence"))
print(udf3conf)
# Lets plot.
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf3) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf3conf, width = 0.1, col = 2)
library(ggplot2)
p <- ggplot(ToothGrowth) + facet_wrap(~ supp)
fm3 <- lm(len ~ log(dose), data = ToothGrowth)
udf <- unique(ToothGrowth[-1])
predict(fm3, udf)
udf3 <- cbind(udf, fit = predict(fm3, udf))
udf3conf <- cbind(udf, predict(fm3, udf, interval = "confidence"))
print(udf3conf)
# Lets plot.
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf3) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf3conf, width = 0.1, col = 2)
# Extension of the above model to allow different intercepts for different supplement types.
# This is an additive model.
fm7 <- aov(len ~ supp + log(dose), data = ToothGrowth)
udf <- unique(ToothGrowth[-1])
predict(fm7, udf)
udf7 <- cbind(udf, fit = predict(fm7, udf))
udf7conf <- cbind(udf, predict(fm7, udf, interval = "confidence"))
print(udf7conf)
# Lets plot.
p + geom_point(aes(x = dose, y = len)) +
geom_line(aes(x = dose, y = fit), data = udf7) +
geom_errorbar(aes(x = dose, ymin = lwr, ymax = upr), data = udf7conf, width = 0.1, col = 2)
library(ggplot2)
library(NHANES)
install.packages("NHANES")
library(NHANES)
nhsub < subset(NHANES, Age >= 21)
nhsub <- nhsub[c("BPSysAve", "Age", "Gender")]
nhsub < subset(NHANES, Age >= 21)
nhsub <- subset(NHANES, Age >= 21)
nhsub <- nhsub[c("BPSysAve", "Age", "Gender")]
str(nhsub)
fm1 <- lm(BPSysAve ~ Age, data = nhsub)
sort(unique(nhsub$Age))
udf <- with(nhsub, expand.grid(Gender = unique(Gender), Age = sort(unique(Age))))
udf
udf1conf <- cbind(udf, predict(fm1, udf), interval = "confidence")
p <- ggplot(nhsub) + facet_wrap(~ Gender) + geom_point(aes(x = Age, y = BPSysAve, alpha = 0.2))
p + geom_errorbar(aes(x = Age, ymin = lwr, ymax = upr), data = udf1conf, col = 2)
udf1conf <- cbind(udf, predict(fm1, udf), interval = "confidence")
p + geom_errorbar(aes(x = Age, ymin = lwr, ymax = upr), data = udf1conf, col = 2)
p <- ggplot(nhsub) + facet_wrap(~ Gender) + geom_point(aes(x = Age, y = BPSysAve, alpha = 0.2))
p + geom_errorbar(aes(x = Age, ymin = lwr, ymax = upr), data = udf1conf, col = 2)
udf1conf
nhsub <- nhsub[c("BPSysAve", "Age", "Gender")]
p <- ggplot(nhsub) + facet_wrap(~ Gender) + geom_point(aes(x = Age, y = BPSysAve, alpha = 0.2))
p + geom_errorbar(aes(x = Age, ymin = lwr, ymax = upr), data = udf1conf, col = 2)
fm1 <- lm(BPSysAve ~ Age, data = nhsub)
udf1conf <- cbind(udf, predict(fm1, udf), interval = "confidence")
udf1conf
p <- ggplot(nhsub) + facet_wrap(~ Gender) + geom_point(aes(x = Age, y = BPSysAve, alpha = 0.2))
p + geom_errorbar(aes(x = Age, ymin = lwr, ymax = upr), data = udf1conf, col = 2)
library(ggplot2)
library(NHANES)
nhsub <- subset(NHANES, Age >= 21)
nhsub <- nhsub[c("BPSysAve", "Age", "Gender")]
str(nhsub)
fm1 <- lm(BPSysAve ~ Age, data = nhsub)
sort(unique(nhsub$Age))
udf <- with(nhsub, expand.grid(Gender = unique(Gender), Age = sort(unique(Age))))
udf
udf1conf <- cbind(udf, predict(fm1, udf), interval = "confidence")
udf1conf
p <- ggplot(nhsub) + facet_wrap(~ Gender) + geom_point(aes(x = Age, y = BPSysAve, alpha = 0.2))
p + geom_errorbar(aes(x = Age, ymin = lwr, ymax = upr), data = udf1conf, col = 2)
udf1 <- cbind(udf, fit = predict(fm1, udf))
udf1conf <- cbind(udf, predict(fm1, udf1), interval = "confidence")
udf1conf
p <- ggplot(nhsub) + facet_wrap(~ Gender) + geom_point(aes(x = Age, y = BPSysAve, alpha = 0.2))
p + geom_errorbar(aes(x = Age, ymin = lwr, ymax = upr), data = udf1conf, col = 2)
udf1conf <- cbind(udf, predict(fm1, udf), interval = "confidence")
udf1conf
p <- ggplot(nhsub) + facet_wrap(~ Gender) + geom_point(aes(x = Age, y = BPSysAve, alpha = 0.2))
p + geom_errorbar(aes(x = Age, ymin = lwr, ymax = upr), data = udf1conf, col = 2)
